<div class="background-container">
    <div class="response-container">
        <div class="panels">
            <!-- Panel 1: Drag & Drop -->
            <div class="panel upload-panel"
                     [class.drag-over]="dragOver()"
                     (dragover)="onDragOver($event)"
                     (dragleave)="onDragLeave($event)"
                     (drop)="onDrop($event)">
                <div class="drop-instructions" *ngIf="!previewUrl()">
                    <p><strong>Arrastra y suelta</strong> una imagen aquí o haz clic para seleccionar</p>
                    <input type="file" accept="image/*" (change)="onFileChange($event)" />
                </div>
                <div class="preview" *ngIf="previewUrl()">
                    <img [src]="previewUrl()" alt="preview" />
                    <button type="button" (click)="clear()" class="clear-btn">Cambiar imagen</button>
                </div>
                <div class="hint" *ngIf="loading()">Analizando imagen...</div>
                <div class="error" *ngIf="error()">{{ error() }}</div>
            </div>

            <!-- Panel 2: Response -->
            <div class="panel response-panel">
                <h3>Resultado</h3>
                <div *ngIf="loading()" class="loading-spinner">Cargando...</div>
                <ng-container *ngIf="!loading()">
                    <div *ngIf="parsedAnalysis(); else rawBlock">
                        <p class="descripcion" *ngIf="descripcion()">{{ descripcion() }}</p>
                        <ul class="labels" *ngIf="labels().length">
                            <li *ngFor="let l of labels()">
                                <span class="label">{{ l.label }}</span>
                                <span class="confidence">{{ (l.confidence * 100) | number:'1.0-1' }}%</span>
                            </li>
                        </ul>
                    </div>
                    <ng-template #rawBlock>
                        <p *ngIf="!previewUrl()">Selecciona una imagen para ver el análisis aquí.</p>
                        <pre *ngIf="messages().length" class="raw-json">{{ messages()[messages().length - 1].content }}</pre>
                    </ng-template>
                </ng-container>
            </div>
        </div>
    </div>
</div>